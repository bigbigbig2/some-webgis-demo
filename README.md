## æœ¬åœ°è¿è¡Œ

å·²å®Œæˆéƒ¨åˆ†æˆªå›¾ï¼š

![image-20231008142423232](README.assets/image-20231008142423232.png)

![image-20231008142504431](README.assets/image-20231008142504431.png)

![image-20231008142520857](README.assets/image-20231008142520857.png)

![image-20231008142546236](README.assets/image-20231008142546236.png)



## phongç€è‰²æ¨¡å‹

![image-20230412223531230](README.assets/image-20230412223531230.png)

ä½¿ç”¨OGLï¼ˆè½»é‡çº§webglåº“ï¼‰ï¼Œæ¸²æŸ“åˆ›å»ºå¤©ç©ºç›’ã€çƒä½“å¹¶è´´å›¾ä½åˆ†è¾¨ç‡ä¸–ç•Œå«æ˜Ÿå½±åƒåœ°å›¾ï¼Œç„¶åå®ç°ç¯å¢ƒå…‰å’Œä¸€ä¸ªå¹³è¡Œå…‰çš„æ¼«åå°„ã€é•œé¢åå°„ã€ä¸€ä¸ªç‚¹å…‰æºçš„æ¼«åå°„ã€é•œé¢åå°„

## å…¨çƒç½‘ç»œæ€§èƒ½æŒ‡æ ‡åŠ¨æ€æ ¼ç½‘ç»Ÿè®¡åˆ†æ
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/6305d0d104a34697af6d230c8a9e21cd.gif#pic_center)


é‡‡ç”¨pgçš„å…­è¾¹å½¢æ ¼ç½‘ç”Ÿæˆå‡½æ•°åŠ¨æ€èšåˆè®¡ç®—æ ¼ç½‘åŒºåŸŸå†…çš„ç½‘ç»œæ€§èƒ½æŒ‡æ ‡ï¼Œæœ€åä½¿ç”¨åŠ¨æ€çŸ¢é‡åˆ‡ç‰‡çš„æ–¹å¼å°†ç”Ÿæˆçš„æ ¼ç½‘æ•°æ®ä»¥Mvtçš„å½¢å¼è¿”å›ç»™å‰ç«¯ï¼ŒåŠ¨æ€çŸ¢é‡åˆ‡ç‰‡æœåŠ¡é‡‡ç”¨node.jsæ­å»º

å‰ç«¯åˆ™é‡‡ç”¨mapboxglçš„å°†mvtæ•°æ®ä¸­è¦ç´ å±æ€§æå–åšè¡¨è¾¾å¼case(if)è¿ç®—å®ç°åŒºç›¸åº”çš„ç¬¦å·ç³»ç»Ÿã€‚

## è‡ªå®šä¹‰å»ºç­‘ç‰©æ ·å¼

ä½¿ç”¨mapboxglçš„customLayerAPI æ¥å…¥deckGLçš„MvtLayerå¯å®ç°å¤§è§„æ¨¡mvtç“¦ç‰‡æ•°æ®çš„æ¸²æŸ“ä¸æ ·å¼å®æ—¶æ›´æ–°è‡ªå®šä¹‰ï¼Œåœ¨æˆ–è€…ç¼–å†™shaderæ³¨å…¥å®ç°ä¸€äº›æ›´é«˜çº§çš„æ•ˆæœ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/23f0718d74a24d4e82effe9854e8475a.png)


æ•°æ®å¤„ç†æ–¹å¼ï¼šåœ¨ç½‘ä¸Šä¸‹è½½å¸¦é«˜åº¦å€¼çš„çŸ¢é‡å»ºç­‘ç‰©é¢æ•°æ®ï¼Œé€šå¸¸ä¸ºshpæ ¼å¼çš„ï¼Œå¦‚æœæŠ•å½±ä¸æ˜¯webå¢¨å¡æ‰˜è¿˜éœ€è¦è½¬ä¸ºwebå¢¨å¡æ‰˜ï¼Œç„¶åè½¬ä¸ºgeoJsonæ ¼å¼çš„ï¼ˆç›´æ¥åœ¨QGISä¸­å¯¼å‡ºæ•°æ®é€‰é¡¹ä¸­é€‰æ‹©å³å¯ï¼‰

ç„¶åä½¿ç”¨tippecanoe è¿›è¡ŒçŸ¢é‡åˆ‡ç‰‡ä¸ºMVTæ ¼å¼çš„xyzæ•°æ®ï¼ˆæˆ‘çœ‹DecKGLå¥½åƒå¹¶ä¸æ”¯æŒmbtilesæ•°æ®ï¼‰

```
tippecanoe --no-tile-compression -s EPSG:3857 -ad -an -Z10 -z16 -e gl-3857 -ai building_3857.geojson
```

åœ¨ç¼©æ”¾çº§åˆ« 10-15 æ—¶ï¼Œç›¸å¯¹è¾ƒå°çš„å»ºç­‘ç‰©è¢«ç¨€ç–åŒ–ï¼ŒçŸ¢é‡åˆ‡ç‰‡500K å¤§å°é™åˆ¶ä»¥ä¸‹

- `-pC`:ä¸è¦å‹ç¼© PBF çŸ¢é‡åˆ‡ç‰‡æ•°æ®
- `-ad`or`--drop-fraction-as-needed` :åœ¨æ¯ä¸ªç¼©æ”¾çº§åˆ«ä¸‹åŠ¨æ€åˆ é™¤éƒ¨åˆ†è¦ç´ ï¼Œä»¥å°†å¤§å›¾å—ä¿æŒåœ¨ 500K å¤§å°é™åˆ¶ä»¥ä¸‹
- `-an`or`--drop-smallest-as-needed`:ä»æ¯ä¸ªç¼©æ”¾çº§åˆ«åŠ¨æ€åˆ é™¤æœ€å°çš„è¦ç´ (å¦‚æœ€å°çš„å¤šè¾¹å½¢)ï¼Œä»¥å°†å¤§å›¾å—ä¿æŒåœ¨ 500K å¤§å°é™åˆ¶ä»¥ä¸‹
- `-e`:å°† tiles å†™å…¥æŒ‡å®šç›®å½•è€Œä¸æ˜¯ mbtiles æ–‡ä»¶
- `-ai`:å¦‚æœè¦ç´  ID æ˜¯æ•°å­—çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ï¼Œè¯·å°†å…¶è½¬æ¢ä¸ºçº¯æ•°å­—ä»¥ç”¨ä½œè¦ç´  ID
- `-s`:æŒ‡å®šæŠ•å½±ï¼Œé»˜è®¤ä¸º3857



## é›¨æ°´åˆ†å¸ƒå›¾

æ•°æ®ï¼šé€šè¿‡axiosè·å–http://typhoon.zjwater.gov.cn/ï¼ˆæµ™æ±Ÿæ°´åˆ©å…ï¼‰ä¸­å®æ—¶çš„é™é›¨JSONæ•°æ®,ç„¶åä½¿ç”¨openlayersè§£æä½¿ç”¨
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/f0867239e0664b659e0b92f6e67f9218.gif)


## åœ°çƒæ‘çš„å¤œæ™š

ä½¿ç”¨`openlayers`è°ƒç”¨`geoserver`å‘å¸ƒçš„`WMTS`æœåŠ¡å¹¶ä½¿ç”¨åˆ‡ç‰‡ç¼“å­˜çš„æ–¹å¼ï¼ˆç”±äºäº‘æœåŠ¡å™¨é…ç½®ä½ï¼Œæ‰€ä»¥åœ¨wimdowä¸Šåˆ‡ç‰‡ï¼Œå°†åˆ‡å¥½çš„æ•°æ®ä¸Šä¼ åˆ°äº‘æœåŠ¡å™¨çš„geoserveråˆ‡ç‰‡ç¼“å­˜ç›®å½•ä¸‹ï¼Œç„¶åç›´æ¥è°ƒç”¨ï¼‰

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/ac83ecab0a2f4499bb8fc4589edde160.png)


å·å¸˜çš„å·¦ä¾§ä¸º2012å¹´çš„åœ°çƒå¤œé—´ç¯å…‰æ•°æ®ï¼Œå³ä¾§ä¸º2016å¹´çš„åœ°çƒå¤œé—´ç¯å…‰æ•°æ®ï¼Œå¯ä»¥æ‹–åŠ¨æ‹–åŠ¨å·å¸˜æ¡æ‹–åŠ¨å¯¹æ¯”æ¢ç´¢ğŸŒğŸŒğŸŒï¼Œæ•°æ®æ¥æºäºNASAã€‚

## é€šè¿‡WFSæŸ¥è¯¢è¦ç´ 

`shp`æ•°æ®(ä¸‹è½½äº`OSM`è·¯ç½‘æ•°æ®ï¼‰å­˜å‚¨äº`postgresql/postgis`ï¼Œåœ¨`geoserver`è¿æ¥`postgis`å‘å¸ƒå›¾å±‚ï¼Œä¾›ç»™openlayersè°ƒç”¨ï¼ˆ`openlayers`ä¸æ”¯æŒ`shpfile`ï¼Œéœ€é€šè¿‡`api`è½¬æˆ`geoJSON`ï¼‰

æŸ¥è¯¢è¦ç´ ï¼ˆæƒ…å†µ1ï¼šæœªåŠ è½½ï¼‰

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/b6c631e31feb488eb67cd1c5c63beeab.gif#pic_center)


æŸ¥è¯¢è¦ç´ ï¼ˆæƒ…å†µ2ï¼šå·²åŠ è½½ï¼‰
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/73368005f5ea4d3a8786d12c27f22c7a.gif#pic_center)



## é€šè¿‡WFSä¿®æ”¹è¦ç´ å¹¶ä¿å­˜åˆ°æ•°æ®åº“

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/1d538b7cb3bc4a939262bedc809fa256.gif#pic_center)


> ä¸ºäº†é™ä½gifæ–‡ä»¶å¤§å°ï¼Œå°†æµè§ˆå™¨çª—å£å‡å°å’Œå‡ä½äº†FPSï¼Œå°†å°±çœ‹çœ‹â‰¡[ã€‚ã€‚]â‰¡

## é€šè¿‡WFSæ·»åŠ è¦ç´ 

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/89491daf15c44bc199b4a406a3b99d9f.gif#pic_center)


ç”±äºæ•°æ®æºçš„åŸå› ï¼Œæ— æ³•çœŸæ­£çš„ä¿å­˜åˆ°æ•°æ®åº“ï¼ˆå·æ‡’ä¸€ä¸‹ï¼Œæ‡’å¾—æŠ˜è…¾äº†Ïˆ(._. )>)

## é€šè¿‡WFSåˆ é™¤è¦ç´ 

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/493fcb9f88194fb8a5b964fe0db02d95.gif#pic_center)
